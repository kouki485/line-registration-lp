<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>副収入で月50万円を目指す - LINE無料登録</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="container">
      <!-- LP画像をそのまま表示 -->
      <img src="lp2.png" alt="副収入LP" class="lp-image">
      
      <!-- クリック可能なLINE登録ボタンエリア -->
      <!-- 1つ目のLINE登録ボタン（上部） -->
      <a href="https://ideaofficial.link-lc.com/adoptin/1/?elinktag=3viiRysL" class="everline_link" target="_blank" rel="noopener noreferrer">
        <img src="line-button.png" alt="LINE登録ボタン" class="line-button line-button-1">
      </a>
      
      <!-- 2つ目のLINE登録ボタン（中部） -->
      <a href="https://ideaofficial.link-lc.com/adoptin/1/?elinktag=3viiRysL" class="everline_link" target="_blank" rel="noopener noreferrer">
        <img src="line-button.png" alt="LINE登録ボタン" class="line-button line-button-2">
      </a>
      
      <!-- 3つ目のLINE登録ボタン（下部1） -->
      <a href="https://ideaofficial.link-lc.com/adoptin/1/?elinktag=3viiRysL" class="everline_link" target="_blank" rel="noopener noreferrer">
        <img src="line-button.png" alt="LINE登録ボタン" class="line-button line-button-3">
      </a>
    </div>
    
    <script type='text/javascript' src='https://ideaofficial.link-lc.com/adoptin/js/1/access.js'></script>
    <script src="script.js"></script>
    <!-- elink計測スクリプトを先に読み込み -->
    <!-- CV計測用スクリプト（友だち登録後の誘導LP用） -->
    <script type='text/javascript' src='https://ideaofficial.link-lc.com/js/everline_cvset.js'></script>
    <script>
      // elink計測スクリプトの初期化完了を待つ
      function waitForElink(callback) {
        if (typeof window.elink !== 'undefined' || typeof window.adoptin !== 'undefined') {
          callback();
        } else {
          setTimeout(() => waitForElink(callback), 100);
        }
      }

      document.addEventListener('DOMContentLoaded', function () {
        console.log('🔍 elink計測スクリプト開始');
        
        const params = new URLSearchParams(window.location.search);
        const euid = params.get("euid");           // euidパラメータ
        const uid = params.get("uid");             // uidパラメータ
        
        console.log('🆔 euid:', euid);
        console.log('🆔 uid:', uid);
    
        const baseUrl = "https://ideaofficial.link-lc.com/adoptin/1/";
        
        // URLにパラメータを追加する共通関数
        function buildUrlWithParams(baseUrl, params) {
          const url = new URL(baseUrl);
          Object.entries(params).forEach(([key, value]) => {
            if (value !== null && value !== undefined && value !== '') {
              url.searchParams.append(key, value);
            }
          });
          return url.toString();
        }
    
        const links = document.querySelectorAll("a.everline_link");
        console.log('🔗 見つかったリンク数:', links.length);
        
        // elink計測スクリプトの初期化完了を待ってからリンクを書き換え
        waitForElink(() => {
          console.log('✅ elink計測スクリプト初期化完了');
          
          // BOT IDを確認
          const currentBotId = checkBotId();
          console.log('🤖 使用中のBOT ID:', currentBotId);
          
          // リンククリック時の軽量な計測を設定する関数
          function setupClickTracking(link, url) {
            link.addEventListener('click', function(e) {
              console.log('🔥 リンククリック検出:', url);
              console.log('📱 デバイス情報:', navigator.userAgent);
              
              // モバイル環境チェック
              const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
              console.log('📱 モバイル環境:', isMobile ? 'Yes' : 'No');
              
              // クリック計測のみ実行（登録完了計測は実行しない）
              try {
                // 1. クリック計測情報をLocalStorageに保存
                const clickData = {
                  timestamp: Date.now(),
                  euid: euid,
                  uid: uid,
                  url: url,
                  userAgent: navigator.userAgent,
                  isMobile: isMobile,
                  event: 'click'
                };
                localStorage.setItem('elink_click_' + Date.now(), JSON.stringify(clickData));
                console.log('📊 クリック情報をlocalStorageに保存');
                
                // 2. 軽量なクリック計測ピクセルのみ送信
                sendClickPixel(euid, uid);
                
                console.log('✅ クリック計測完了（登録完了計測は実際の登録後に実行）');
                
              } catch (error) {
                console.error('❌ クリック時計測エラー:', error);
              }
            });
          }
          
          // uid/euidパラメータでURL構築
          const finalUrl = buildUrlWithParams(baseUrl, {
            euid: euid || '###uid###',  // 既存のeuidがあればそれを使用、なければデフォルト
            uid: uid
          });
          console.log('✅ URL構築完了 → ', finalUrl);
          
          links.forEach(link => {
            link.href = finalUrl;
            link.style.pointerEvents = "auto";
            link.style.opacity = "1";
            setupClickTracking(link, finalUrl);
          });
          
          console.log('🎯 elink計測スクリプト完了');
        });
        
        // 軽量なクリック計測ピクセル送信関数
        function sendClickPixel(euid, uid) {
          const pixelImg = document.createElement('img');
          pixelImg.style.display = 'none';
          pixelImg.style.width = '1px';
          pixelImg.style.height = '1px';
          
          let trackingUrl = 'https://ideaofficial.link-lc.com/adoptin/1/click.gif?';
          const params = new URLSearchParams();
          
          if (euid) params.append('euid', euid);
          if (uid) params.append('uid', uid);
          params.append('event', 'click');
          params.append('_t', Date.now().toString());
          
          pixelImg.src = trackingUrl + params.toString();
          document.body.appendChild(pixelImg);
          
          console.log('📊 クリック計測ピクセル送信:', pixelImg.src);
          
          // 3秒後に削除
          setTimeout(() => {
            if (pixelImg.parentNode) {
              pixelImg.parentNode.removeChild(pixelImg);
            }
          }, 3000);
        }
        
        // BOT ID確認関数
        function checkBotId() {
          // 現在のスクリプトソースからBOT IDを確認
          const scripts = document.querySelectorAll('script[src*="ideaofficial.link-lc.com/adoptin/js/"]');
          let botId = '1'; // デフォルト値
          
          scripts.forEach(script => {
            const match = script.src.match(/\/adoptin\/js\/(\d+)\/access\.js/);
            if (match) {
              botId = match[1];
            }
          });
          
          console.log('🤖 検出されたBOT ID:', botId);
          return botId;
        }
      });
    </script>
</body>
</html> 